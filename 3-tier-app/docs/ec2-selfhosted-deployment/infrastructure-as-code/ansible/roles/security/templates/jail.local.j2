# Fail2ban configuration for {{ app.name }}
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

[DEFAULT]
# Ban time in seconds (1 hour)
bantime = 3600

# Find time window (10 minutes)
findtime = 600

# Number of failures before ban
maxretry = 5

# Ignore local IPs
ignoreip = 127.0.0.1/8 ::1 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 7200

[nginx-http-auth]
enabled = true
filter = nginx-http-auth
port = http,https
logpath = {{ nginx.error_log }}

[nginx-limit-req]
enabled = true
filter = nginx-limit-req
port = http,https
logpath = {{ nginx.error_log }}

[nginx-botsearch]
enabled = true
filter = nginx-botsearch
port = http,https
logpath = {{ nginx.access_log }}
maxretry = 2
